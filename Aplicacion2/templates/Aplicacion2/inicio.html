{% extends "base.html" %}
{% load static %}

{% block title %}Inicio - Juegos Motrices{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/inicio.css' %}">

<!-- =========================
     ğŸŒŸ HERO PRINCIPAL
========================= -->
<section id="hero" class="hero container d-flex flex-column flex-lg-row align-items-center justify-content-between py-5 position-relative">
  <div class="hero-content text-center text-lg-start mb-4 mb-lg-0 animate__animated animate__fadeInLeft">
    <h1 class="fw-bold display-4 mb-3">
      ğŸ‰ Â¡Bienvenido a <span class="text-gradient">Juegos Motrices</span>!
    </h1>
    <p class="lead mt-3">
      Actividades inclusivas para <strong>niÃ±as y niÃ±os</strong> con diferentes capacidades.
      Controles grandes, colores claros y una navegaciÃ³n accesible y divertida.
    </p>

    {% if user.is_authenticated %}
      <p class="mt-3">ğŸ‘‹ Hola <strong>{{ user.username }}</strong></p>

      <div class="d-flex flex-column flex-sm-row gap-3 mt-4">
            <a class="btn btn-lg btn-warning px-4 py-2 shadow-lg rounded-pill hero-btn" href="{% url 'Aplicacion2:juegos' %}">
              ğŸ® Probar Juegos
            </a>
            <a class="btn btn-outline-primary px-4 py-2 rounded-pill" href="{% url 'Aplicacion2:tienda' %}">
              ğŸ›’ Ir a la Tienda
            </a>

        <a class="btn btn-outline-dark px-4 py-2 rounded-pill"
           href="{% url 'Aplicacion2:salir' %}">
          ğŸšª Cerrar sesiÃ³n
        </a>
      </div>
    {% else %}
      <div class="d-flex flex-column flex-sm-row gap-3 mt-4">
        <a class="btn btn-lg btn-success px-4 py-2 shadow-lg rounded-pill hero-btn"
           href="{% url 'Aplicacion2:registro_padre' %}">
          ğŸ“ Crear Cuenta
        </a>
        <a class="btn btn-outline-dark px-4 py-2 rounded-pill"
           href="{% url 'Aplicacion2:login' %}">
          ğŸ”‘ Iniciar sesiÃ³n
        </a>
      </div>
    {% endif %}
  </div>

  <figure class="hero-figure text-center animate__animated animate__zoomIn">
    <img src="{% static 'img/niÃ±os_jugando.jpg' %}"
         alt="NiÃ±os jugando"
         class="hero-img img-fluid rounded shadow-lg"
         loading="lazy">
  </figure>
</section>

<!-- =========================
     ğŸ® JUEGOS DESTACADOS - CARRUSEL
========================= -->
<section id="games" class="container py-5">
  <h2 class="section-title text-center mb-5">âœ¨ Juegos Destacados</h2>

  {% if juegos %}
    <div id="juegosCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="4000">
      <!-- Indicadores -->
      <div class="carousel-indicators">
        {% for juego in juegos|slice:":6" %}
          <button type="button" data-bs-target="#juegosCarousel" data-bs-slide-to="{{ forloop.counter0 }}" 
                  class="{% if forloop.first %}active{% endif %}" aria-current="{% if forloop.first %}true{% endif %}" 
                  aria-label="Slide {{ forloop.counter }}"></button>
        {% endfor %}
      </div>

      <!-- Slides del carrusel -->
      <div class="carousel-inner rounded-4 shadow-lg">
        {% for juego in juegos|slice:":6" %}
          <div class="carousel-item {% if forloop.first %}active{% endif %}">
            <div class="row align-items-center g-0 carousel-slide">
              <!-- Imagen del juego -->
              <div class="col-md-6">
                <div class="position-relative overflow-hidden rounded-start-4">
                  <img src="{{ juego.imagen.url }}" alt="Captura de {{ juego.titulo }}" 
                       class="carousel-game-img w-100 h-100 object-fit-cover">
                  <div class="carousel-overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center">
                    <div class="text-center text-white">
                      <i class="bi bi-play-circle-fill" style="font-size: 4rem; opacity: 0.8;"></i>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- InformaciÃ³n del juego -->
              <div class="col-md-6">
                <div class="carousel-content p-4 h-100 d-flex flex-column justify-content-center">
                  <div>
                    <span class="badge bg-primary mb-2">ğŸ® {{ juego.categoria.nombre|default:"Juego" }}</span>
                    <h3 class="fw-bold text-dark mb-3">{{ juego.titulo }}</h3>
                    <p class="text-muted mb-3">{{ juego.descripcion|truncatewords:20 }}</p>
                    <div class="mb-3">
                      <small class="text-info">
                        <i class="bi bi-people-fill me-1"></i>Edad: {{ juego.edad_recomendada|default:"Todas" }}+
                      </small>
                    </div>
                    <div class="d-flex gap-2">
                      <a href="{% url 'Aplicacion2:juego_detalle' juego.id %}" 
                         class="btn btn-primary rounded-pill px-4 py-2 shadow-sm">
                        â–¶ï¸ Jugar Ahora
                      </a>
                      <a href="{% url 'Aplicacion2:juegos' %}" 
                         class="btn btn-outline-secondary rounded-pill px-3 py-2">
                        Ver MÃ¡s
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Controles del carrusel -->
      <button class="carousel-control-prev" type="button" data-bs-target="#juegosCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon bg-primary rounded-circle p-3" aria-hidden="true"></span>
        <span class="visually-hidden">Anterior</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#juegosCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon bg-primary rounded-circle p-3" aria-hidden="true"></span>
        <span class="visually-hidden">Siguiente</span>
      </button>
    </div>

    <!-- Juegos en miniatura debajo del carrusel -->
    <div class="row g-3 mt-4 justify-content-center">
      {% for juego in juegos|slice:"6:10" %}
        <div class="col-lg-2 col-md-3 col-sm-4 col-6">
          <div class="card game-mini-card h-100 text-center border-0 shadow-sm">
            <img src="{{ juego.imagen.url }}" alt="{{ juego.titulo }}" class="game-mini-img rounded-top">
            <div class="card-body p-2">
              <h6 class="fw-bold mb-1 small">{{ juego.titulo|truncatechars:15 }}</h6>
              <a href="{% url 'Aplicacion2:juego_detalle' juego.id %}" 
                 class="btn btn-primary btn-sm rounded-pill px-2 py-1">
                â–¶ï¸
              </a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

  {% else %}
    <div class="text-center py-5">
      <div class="card mx-auto" style="max-width: 400px;">
        <div class="card-body">
          <i class="bi bi-controller display-4 text-muted mb-3"></i>
          <h5 class="card-title">Â¡PrÃ³ximamente!</h5>
          <p class="text-muted">No hay juegos cargados todavÃ­a. Â¡Vuelve pronto para descubrir increÃ­bles juegos!</p>
        </div>
      </div>
    </div>
  {% endif %}
</section>

<!-- =========================
     ğŸ›ï¸ TIENDA MOTRIZ
========================= -->
<section id="shop" class="container py-5 position-relative">
  <h2 class="section-title text-center mb-5">ğŸ›’ Tienda Motriz</h2>

  <div class="row g-4 justify-content-center">
    {% for producto in productos|slice:":8" %}
      <div class="col-lg-3 col-md-4 col-sm-6">
        <div class="card shop-card h-100 text-center border-0 shadow-sm animate__animated animate__fadeInUp">
          <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}" class="shop-img rounded-top">
          <div class="card-body">
            <h5 class="fw-bold mb-2">{{ producto.nombre }}</h5>
            <p class="text-muted small mb-2">{{ producto.descripcion|truncatewords:12 }}</p>
            <p class="fw-bold text-success mb-3">$ {{ producto.precio }}</p>
            <button class="btn btn-success rounded-pill add-to-cart px-3 py-2"
                    data-name="{{ producto.nombre }}"
                    data-price="{{ producto.precio }}"
                    title="Agregar al carrito">
              ğŸ›ï¸ Agregar
            </button>
          </div>
        </div>
      </div>
    {% empty %}
      <p class="text-center text-muted">âš ï¸ No hay productos disponibles.</p>
    {% endfor %}
  </div>

  <!-- ğŸ§º Carrito flotante -->
  <div id="cart" class="cart shadow-lg p-3 rounded glass animate__animated animate__fadeInUp">
    <div class="d-flex justify-content-between align-items-center mb-2">
      <h5 class="m-0">ğŸ›ï¸ Tu Carrito</h5>
      <button id="clear-cart" class="btn btn-sm btn-outline-danger">Vaciar</button>
    </div>
    <ul id="cart-items" class="list-unstyled small mb-2"></ul>
    <p class="fw-bold mt-2 text-end">Total: $<span id="cart-total">0</span></p>
  </div>
</section>

<!-- =========================
     âš™ï¸ PANEL DE GESTIÃ“N (solo propietarios)
========================= -->
{% if user.is_authenticated and user.perfil.es_propietario %}
<section class="container py-5 text-center">
  <h2>âš™ï¸ Panel de GestiÃ³n</h2>
  <a href="{% url 'Aplicacion2:gestion_juegos' %}" class="btn btn-primary px-4 py-2 rounded-pill shadow mt-3">
    â• Agregar / Editar Juegos
  </a>
</section>
{% endif %}

<script src="{% static 'js/inicio.js' %}"></script>
{% endblock %}
